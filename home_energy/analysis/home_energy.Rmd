---
title: "Home Energy Analysis"
output: html_notebook
---


```{r}

library(shiny)
library(shinydashboard)
library(tidyverse)
library(sf)
library(here)
library(scales)
library(leaflet)
library(htmltools)
library(janitor)
```

#Reading in cleaned file
```{r}
home_energy <- read_csv(here("clean_data/home_energy.csv"))
```


#Table of the means per town for each year
```{r}
energy_means <- home_energy %>% 
  group_by(ca_name, year) %>% 
  summarise(mean_co2_pfa = round(mean(co2_emissions_per_floor_area), digits = 2),
            mean_primary_energy = round(mean(primary_energy), digits = 2),
            mean_current_emissions = round(mean(current_emissions_t_co2_yr), digits = 2))
energy_means
```

#Visualising mean_co2_emissions_current_per_floor_area for cities from 2012 to 2020
```{r}

mean_co2_emissions <- energy_means %>% 
  group_by(ca_name) %>% 
  summarise(mean_co2_emissions_pfa = round(mean(mean_co2_pfa), digits = 2))

mean_co2_emissions

```

```{r}
mean_co2_emissions %>% 
  ggplot() +
  aes(x = mean_co2_emissions_pfa, y = ca_name) +
  geom_col(fill = "dark green") +
  theme_minimal() +
  labs(
    y = "Council Area",
    x = "Mean CO2 Emissions Per Current Floor Area (kg CO2/m^2/Year)",
    title = "Mean CO2 Emissions Current Floor Area of Homes by Council Area",
    subtitle = "2012 - 2020"
  ) +
  theme(axis.text.x = element_text(angle=45,hjust=1)) 

```



# Visualising Mean Primary Energy Indicator of Homes by Council Area

```{r}

mean_primary_energy_all <- energy_means %>% 
  group_by(ca_name) %>% 
  summarise(mean_primary_energy = round(mean(mean_primary_energy), digits = 2))

mean_primary_energy_all
```

```{r}
mean_primary_energy_all %>% 
  ggplot() +
  aes(x = mean_primary_energy, y = ca_name) +
  geom_col(fill = "dark green") +
  theme_minimal() +
  labs(
    y = "Council Area",
    x = "Mean Primary Energy Indicator (kWh/m^2/yr)",
    title = "Mean Primary Energy Indicator of Homes by Council Area",
    subtitle = "2012 - 2020"
  ) +
  theme(axis.text.x = element_text(angle=45,hjust=1)) 

mean_primary_energy_all
```


# Visualising Mean Current Emissions of Homes by Council Area (Tonnes CO2/Year) 
```{r}
mean_current_emissions <- energy_means %>% 
  group_by(ca_name) %>% 
  summarise(mean_current_emissions_all = round(mean(mean_current_emissions), digits = 2))

mean_current_emissions

mean_current_emissions %>% 
  ggplot() +
  aes(x = mean_current_emissions_all, y = ca_name) +
  geom_col(fill = "dark green") +
  theme_minimal() +
  labs(
    y = "Council Area",
    x = "Mean Current Emissions (Tonnes CO2/Year)",
    title = "Mean Current Emissions of Homes by Council Area",
    subtitle = "2012 - 2020"
  ) +
  theme(axis.text.x = element_text(angle=45,hjust=1)) 
```


